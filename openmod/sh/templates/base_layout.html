<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>openMod.sh</title>

	<link rel="stylesheet" type="text/css" href="/static/bootstrap/css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="/static/css/style.css">
	<link rel="stylesheet" href="/static/jquery-ui.min.css"/>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

	{% block head %}
	{% endblock %}

  </head>
  <body>
  	<header>
  		<div class="row align-items-center">
		  	<div class="col-2 logo">
			  	<div class="name">
			  		OPENMOD.SH <span>0.2</span>
			  	</div>
			  	Energiekollektiv
		  	</div>
		  	<div class="col">
  				<ul class="nav">
					<li class="nav-item">
						<a class="nav-link" href="scenario_overview">Scenario Overview</a>
					</li>
					<li class="nav-item" onclick="openImportModal()">
						<a class="nav-link" href="javascript:void(0)">Import</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="jobs">Jobs</a>
					</li>
				</ul>
			</div>
		  	<div class="col-2">
  				<ul class="nav">
  				    <!-- TODO: Add help page -->
					<li class="nav-item">
						<a class="nav-link" href="#">Help</a>
					</li>
  				    <!-- TODO: User name should be showing up here -->
					<li class="nav-item">
						<a class="nav-link" href="#">User</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="logout">Logout</a>
					</li>
				</ul>
			</div>
		</div>
  	</header>
  	<nav class="subnav">
	  	<div class="col">
			<ul class="nav">
            
            {% block submenu %}
            {% endblock %}
            
			</ul>
		</div>  		
  	</nav>

		<!-- Import Modal -->
        <div class="modal fade" id="importModal" tabindex="-1" role="dialog" aria-labelledby="importModalLabel" aria-hidden="true">
          <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="importModalLabel">Import a scenario</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">
                You can import scenarios only in the openmod.sh specific JSON-format.
                <!-- TODO: Fine tune to handle success error response and ask for alternative scenario name -->
                <form id="input-file-form">
                    <div class="form-group">
                        <label for="input-file-select">Choose file:</label>
                        <input type="file" id="input-file-select" class="form-control-file" id="scenarioInputFile" aria-describedby="fileHelp " name="scenariofiles">
                        <small id="fileHelp" class="form-text text-muted">The file has to be a json-file following the openmod.sh API structure.</small>
                        <div id="inputResponse"></div>
                        <button class="btn btn-primary" id="input-upload-button">Upload</button>
                    </div>
                </form>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
              </div>
            </div>
          </div>
        </div>


	{% block content %}
	{% endblock %}

<!--  	<header>
	  	<div class="container">
			<ul class="nav">
				<li class="nav-item logo">
					Energiekollektiv<br />
					<span>openmod.sh</span>
				</li>
				{% block nav %}
				<li class="nav-item">
					<a class="nav-link active" href="#">Overview</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="#">Import</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="#">Compare Results</a>
				</li>
				{% endblock %}
			</ul>
	  	</div>
  	</header>
  	<nav class="subnav">
  		{% block subnav %}
	  	<div class="container">
			<ul class="nav">
				<li class="nav-item">
					<a class="nav-link" href="#">Update</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="#">Save new</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="#">Go to Overview</a>
				</li>
			</ul>
	  	</div>
		{% endblock %}
  	</nav>
	<footer>
		<div class="container">
			<div class="row navfooter">
				<div class="col">
					<b>openmod.sh</b>
					<ul class="nav flex-column">
						<li class="nav-item">
							<a class="nav-link active" href="#">Overview</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="#">Import</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="#">Compare Results</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="#">Logout</a>
						</li>
					</ul>
				</div>
				<div class="col">
					<b>Energiekollektiv</b>
					<ul class="nav flex-column">
						<li class="nav-item">
							<a class="nav-link" href="#">Press Releases</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="#">Mission</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="#">Team</a>
						</li>
					</ul>
				</div>
				<div class="col">
					<b>Externe Links</b>
				</div>
			</div>
			
			<div class="row legalfooter">
				<div class="col-5">
					Energiekollektiv<br />
				   <em>openmod.sh: an oemof based modelling software.</em>
				</div>
				<div class="col">
					Private Policy
				</div>
				<div class="col">
					Terms & Conditions
				</div>
				<div class="col">
					Copyright Notifications
				</div>
			</div>

			<div class="legal">&copy; Copyright 2017 by Energiekollektiv</div>
		</div>
	</footer>-->

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="/static/jquery-ui.min.js"></script>

    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="https://npmcdn.com/tether@1.2.4/dist/js/tether.min.js"></script>
    <script src="/static/bootstrap/js/bootstrap.min.js"></script>
    <script src="/static/helper.js"></script>

<script type="text/javascript">
function openImportModal() {
    $('#importModal').modal();
}

var form = document.getElementById('input-file-form');
var fileSelect = document.getElementById('input-file-select');
var uploadButton = document.getElementById('input-upload-button');

form.onsubmit = function(event) {
    event.preventDefault();

    uploadButton.innerHTML = 'Uploading...';
    var files = fileSelect.files;
    var formData = new FormData();

    for (var i = 0; i < files.length; i++) {
        var file = files[i];

        // TODO: Check the file type.

        // Add the file to the request.
        formData.append('scenariofile', file, file.name);
    }
    var xhr = new XMLHttpRequest();
    xhr.open('POST', 'import', true);
    xhr.onload = function () {
    if (xhr.status === 200) {
        // File(s) uploaded.
        uploadButton.innerHTML = 'Upload another';
        $('#inputResponse').html("Upload successfull!");
    } else if (xhr.status === 409) {
        uploadButton.innerHTML = 'Try again';
        $('#inputResponse').html("Scenario name already taken! ");
        $('#inputResponse').append('<label for="input-scenario-name">Choose a new scenario name:</label>'
                                   +'<input type="text" class="form-control" id="input-scenario-name" placeholder="'+JSON.parse(xhr.responseText)['scenario_name']+'">');
    } else {
        uploadButton.innerHTML = 'Try again';
        $('#inputResponse').html('An error occurred! '+xhr.status);
    }
    };
    if (document.getElementById('input-scenario-name')) {
        formData.append('new_scenario_name', document.getElementById('input-scenario-name').value);
    } else {
        formData.append('new_scenario_name', '');
    }
    xhr.send(formData);
}

</script>

  </body>
</html>
